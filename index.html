<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Cuba Market - Tienda Oficial</title>

<style>
body{
    margin:0;
    font-family: Arial, sans-serif;
    background:linear-gradient(120deg,#eaffd0,#fff9c4);
    color:#222;
    text-align:center;
}

h1{
    margin:20px;
    font-size:42px;
    color:#2e7d32;
    text-shadow:0 0 10px white;
}

.productos{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
    gap:15px;
    max-width:1100px;
    margin:20px auto;
    padding:15px;
}

.card{
    background:white;
    border-radius:18px;
    padding:15px;
    box-shadow:0 0 12px rgba(0,0,0,0.2);
    transition:0.3s;
}

.card:hover{
    transform:scale(1.05);
}

.card button{
    margin-top:10px;
    padding:10px 15px;
    border:none;
    border-radius:12px;
    cursor:pointer;
    background:#43a047;
    color:white;
    font-weight:bold;
}

#totalTop{
    font-size:22px;
    font-weight:bold;
    margin:15px;
    color:#d84315;
}

#carritoPanel{
    position:fixed;
    right:0;
    top:0;
    width:330px;
    height:100%;
    background:white;
    box-shadow:-3px 0 15px rgba(0,0,0,0.3);
    padding:15px;
    overflow:auto;
    display:none;
    z-index:999;
}

#carritoPanel h2{
    color:#2e7d32;
}

.itemCarrito{
    border-bottom:1px solid #ddd;
    padding:10px;
}

.itemCarrito button{
    margin:3px;
    padding:5px 10px;
    border:none;
    border-radius:8px;
    cursor:pointer;
}

.btnMas{background:#2e7d32;color:white;}
.btnMenos{background:#ff9800;color:white;}
.btnEliminar{background:#d32f2f;color:white;}

.toggleBtn{
    background:#1976d2;
    color:white;
    padding:12px 20px;
    border:none;
    border-radius:14px;
    cursor:pointer;
    margin:10px;
    font-weight:bold;
}

details{
    max-width:700px;
    margin:15px auto;
    text-align:left;
    background:white;
    border-radius:15px;
    padding:12px;
    box-shadow:0 0 10px rgba(0,0,0,0.2);
}

summary{
    font-size:18px;
    font-weight:bold;
    cursor:pointer;
    color:#333;
}

input,select{
    width:95%;
    padding:8px;
    margin:5px 0;
    border-radius:10px;
    border:1px solid #aaa;
}

#accionesFinales button{
    width:90%;
    margin:8px auto;
    display:block;
    padding:12px;
    border:none;
    border-radius:14px;
    cursor:pointer;
    font-weight:bold;
}

.btnFactura{background:#2e7d32;color:white;}
.btnComprobante{background:#1976d2;color:white;}
.btnWhats{background:#25d366;color:white;}
.btnWallet{background:gray;color:white;}
</style>
</head>

<body>

<h1>üõí CUBA MARKET üõí</h1>

<div id="totalTop">Total actual: 0 CUP</div>

<button class="toggleBtn" onclick="mostrarCarrito()">üõç Ver Carrito</button>

<input type="text" id="buscador" placeholder="üîç Buscar productos..." onkeyup="filtrarProductos()">

<!-- PRODUCTOS -->
<div class="productos" id="listaProductos"></div>

<!-- PANEL DESPLEGABLE CLIENTE -->
<details>
<summary>üìå Datos del Cliente</summary>
<input id="clienteNombre" placeholder="Nombre y Apellidos">
<input id="clienteDireccion" placeholder="Direcci√≥n">
<input id="clienteTelefono" placeholder="Tel√©fono">
<input id="clienteCI" placeholder="Carnet de Identidad">
<select id="entrega">
<option>Recoger en tienda</option>
<option>Mensajer√≠a</option>
</select>
</details>

<!-- CUP√ìN -->
<details>
<summary>üéÅ Cup√≥n Promocional</summary>
<input id="cupon" placeholder="C√≥digo promocional (PROMO10)">
<button onclick="aplicarCupon()">Aplicar descuento</button>
<p id="estadoCupon"></p>
</details>

<!-- M√âTODOS DE PAGO -->
<details>
<summary>üí≥ M√©todos de Pago</summary>
<p>CRIPTO: 928374</p>
<p>CUP: 837261</p>
<p>USD: 112233</p>
<p>MLC: 445566</p>
<p>CL√ÅSICA: 778899</p>
</details>

<!-- CARRITO -->
<div id="carritoPanel">
<h2>üõí Tu Carrito</h2>
<div id="carritoItems"></div>

<h3 id="totalCarrito">Total: 0 CUP</h3>

<div id="accionesFinales">
<button class="btnFactura" onclick="generarFactura()">üìÑ Descargar Factura PDF</button>
<button class="btnComprobante" onclick="generarComprobante()">üßæ Descargar Comprobante PDF</button>
<button class="btnWhats" onclick="enviarWhats()">üì≤ Enviar Pedido WhatsApp</button>
<button class="btnWallet">üëõ Billetera (Pr√≥ximamente)</button>
<button onclick="ocultarCarrito()">‚ùå Cerrar Carrito</button>
</div>
</div>

<!-- LIBRER√çA PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
let productos = [
 {nombre:"üçó Pollo",precio:3200},
 {nombre:"üçö Arroz 1kg",precio:250},
 {nombre:"üç™ Galletas",precio:180},
 {nombre:"üç¨ Az√∫car 1kg",precio:300},
 {nombre:"üõ¢ Aceite",precio:1200},
 {nombre:"ü•õ Leche en polvo",precio:2800},
 {nombre:"ü•© Picadillo",precio:650},
 {nombre:"üçå Pl√°tanos",precio:600},
 {nombre:"ü•§ Refresco",precio:400},
 {nombre:"üç´ Chocolate",precio:500},
 {nombre:"‚òï Caf√©",precio:2000},
 {nombre:"üçØ Miel",precio:1300},
 {nombre:"üßÄ Queso",precio:2200},
 {nombre:"üçé Manzanas",precio:1200},
 {nombre:"ü•ö Huevos",precio:900},
 {nombre:"ü•ñ Pan",precio:120},
 {nombre:"üêü Pescado",precio:2500},
 {nombre:"üçó Muslo",precio:1800},
 {nombre:"ü•´ Sardinas",precio:600},
 {nombre:"üçù Pasta",precio:450}
];

let carrito=[];
let descuento=0;

function cargarProductos(){
 let cont=document.getElementById("listaProductos");
 cont.innerHTML="";
 productos.forEach((p,i)=>{
   cont.innerHTML+=`
   <div class="card producto">
    <h3>${p.nombre}</h3>
    <p>${p.precio} CUP</p>
    <button onclick="agregarCarrito(${i})">A√±adir</button>
   </div>`;
 });
}
cargarProductos();

function agregarCarrito(i){
 let prod=productos[i];
 let existe=carrito.find(x=>x.nombre==prod.nombre);
 if(existe){existe.cantidad++;}
 else{carrito.push({nombre:prod.nombre,precio:prod.precio,cantidad:1});}
 actualizarCarrito();
}

function actualizarCarrito(){
 let div=document.getElementById("carritoItems");
 div.innerHTML="";
 let total=0;
 carrito.forEach((it,index)=>{
   total+=it.precio*it.cantidad;
   div.innerHTML+=`
   <div class="itemCarrito">
    ${it.nombre} x${it.cantidad} - ${(it.precio*it.cantidad)} CUP<br>
    <button class="btnMas" onclick="sumar(${index})">+</button>
    <button class="btnMenos" onclick="restar(${index})">-</button>
    <button class="btnEliminar" onclick="eliminar(${index})">X</button>
   </div>`;
 });

 total = total - (total*descuento);
 document.getElementById("totalCarrito").innerText="Total: "+total.toFixed(2)+" CUP";
 document.getElementById("totalTop").innerText="Total actual: "+total.toFixed(2)+" CUP";
}

function sumar(i){carrito[i].cantidad++; actualizarCarrito();}
function restar(i){
 if(carrito[i].cantidad>1) carrito[i].cantidad--;
 actualizarCarrito();
}
function eliminar(i){carrito.splice(i,1); actualizarCarrito();}

function mostrarCarrito(){document.getElementById("carritoPanel").style.display="block";}
function ocultarCarrito(){document.getElementById("carritoPanel").style.display="none";}

function filtrarProductos(){
 let texto=document.getElementById("buscador").value.toLowerCase();
 document.querySelectorAll(".producto").forEach(card=>{
   card.style.display=card.innerText.toLowerCase().includes(texto)?"block":"none";
 });
}

function aplicarCupon(){
 let c=document.getElementById("cupon").value.trim();
 if(c=="PROMO10"){
   descuento=0.10;
   document.getElementById("estadoCupon").innerText="‚úÖ Descuento 10% aplicado";
 }else{
   descuento=0;
   document.getElementById("estadoCupon").innerText="‚ùå Cup√≥n inv√°lido";
 }
 actualizarCarrito();
}

function generarFactura(){
 const {jsPDF}=window.jspdf;
 let pdf=new jsPDF();
 pdf.setFont("helvetica");

 pdf.text("CUBA MARKET - FACTURA",20,20);

 let y=40;
 carrito.forEach(it=>{
   pdf.text(`${it.nombre} x${it.cantidad}`,20,y);
   pdf.text(`${it.precio*it.cantidad} CUP`,150,y);
   y+=10;
 });

 pdf.text("Gracias por tu compra ‚ù§Ô∏è",20,y+20);
 pdf.save("factura.pdf");
}

function generarComprobante(){
 const {jsPDF}=window.jspdf;
 let pdf=new jsPDF();
 pdf.text("CUBA MARKET - COMPROBANTE",20,20);
 pdf.text("Pago recibido correctamente.",20,40);
 pdf.save("comprobante.pdf");
}

function enviarWhats(){
 let total=document.getElementById("totalCarrito").innerText;
 let msg="Hola, quiero hacer este pedido en Cuba Market:%0A";
 carrito.forEach(it=>{
   msg+=`${it.nombre} x${it.cantidad}%0A`;
 });
 msg+=`Total: ${total}%0AEnviar factura + captura del pago.`;
 window.open("https://wa.me/58752291?text="+msg);
}
</script>

</body>
    </html>
